# MG Common Game - Submodule Update Notifier
# Notifies game repositories when mg_common_game is updated

name: Notify Games

on:
  push:
    branches: [main]

jobs:
  notify:
    name: Notify Game Repositories
    runs-on: ubuntu-latest
    steps:
      - name: Get commit info
        id: commit
        run: |
          echo "sha=${GITHUB_SHA::7}" >> $GITHUB_OUTPUT
          echo "message=$(git log -1 --pretty=%s)" >> $GITHUB_OUTPUT

      - name: Create dispatch event
        run: |
          echo "mg_common_game updated: ${{ steps.commit.outputs.sha }}"
          echo "Message: ${{ steps.commit.outputs.message }}"
          # In production, you would trigger workflows in game repos:
          # curl -X POST \
          #   -H "Authorization: token ${{ secrets.REPO_ACCESS_TOKEN }}" \
          #   -H "Accept: application/vnd.github.v3+json" \
          #   https://api.github.com/repos/monthly-games/mg-game-0001/dispatches \
          #   -d '{"event_type":"submodule_update","client_payload":{"sha":"${{ steps.commit.outputs.sha }}"}}'
